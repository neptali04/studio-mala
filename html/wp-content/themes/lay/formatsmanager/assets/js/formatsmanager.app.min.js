!function(e){var t={};function o(i){if(t[i])return t[i].exports;var a=t[i]={i:i,l:!1,exports:{}};return e[i].call(a.exports,a,a.exports,o),a.l=!0,a.exports}o.m=e,o.c=t,o.d=function(e,t,i){o.o(e,t)||Object.defineProperty(e,t,{configurable:!1,enumerable:!0,get:i})},o.r=function(e){Object.defineProperty(e,"__esModule",{value:!0})},o.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return o.d(t,"a",t),t},o.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},o.p="",o(o.s=0)}([function(e,t,o){"use strict";function i(e){return(i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}o.r(t);Marionette.View.extend({tagName:"td",template:_.template('\n        <select>\n            <option value="">--SELECT--</option>\n            <%= getOptions() %>\n        </select>\n    '),events:{"change select":"onSelect"},templateContext:function(){var e=this;return{getOptions:function(){for(var t="",o=e.model.get("instances"),i=0;i<o.length;i++){t+='<option value="'+i+'">'+o[i].name.en+"</option>"}return t}}},onSelect:function(){var e=this.$el.find("select").val();e=parseInt(e,10);var t=this.model.get("instances")[e];this.triggerMethod("presetSelected",e,t)},onMaybeDeselect:function(e){var t=this.$el.find("select").val();if(""!=t){t=parseInt(t,10);var o=this.model.get("instances")[t].coordinates;for(var i in o){var a=o[i];if(e.findWhere({tag:i}).get("value")!=a){this.$el.find("option:selected").prop("selected",!1);break}}}},onAttach:function(){jQuery("<td>Variable Font Presets</td>").insertBefore(this.$el)},onRender:function(){var e=this.getOption("selected_index");void 0!==e&&this.$el.find('option[value="'+e+'"]').prop("selected",!0)}});var a,n=Marionette.View.extend({template:_.template('\n        <span><%= getName() %></span>\n        <input data-type="<%= tag %>" value="<%= getValue() %>" type="range" id="start" name="volume" min="<%= minValue %>" max="<%= maxValue %>" />\n    '),templateContext:function(){var e=this;return{getValue:function(){return void 0!==e.model.get("value")?e.model.get("value"):0},getName:function(){var t="";t=e.model.get("tag");var o=e.model.get("name");return null!==o&&"object"==i(o)&&_.has(o,"en")&&(t=o.en),t}}},className:"variable-font-slider",tagName:"div",events:{"input input":"onInput"},onInput:function(){var e=this.$el.find("input").val();this.model.set("value",e),this.triggerMethod("input:triggered",e)},onRender:function(){this.triggerMethod("input")}}),s=(Marionette.CompositeView.extend({template:_.template('\n    <div class="variable-font-headline">Variable Font Axes</div>\n    <div class="collection-container"></div>\n    '),className:"variable-font-slider-collection-view",tagName:"td",childViewContainer:".collection-container",childView:n,onRender:function(){this.$el.attr("colspan",2)},onChildviewInputTriggered:function(){var e="font-variation-settings: ",t=[];this.collection.each(function(e){var o=e.get("value");void 0===o&&(o=0),t.push('"'+e.get("tag")+'" '+o)}),e+=t.join(", "),e+=";",this.triggerMethod("fontAxesUpdated",e,this.collection)}}),{generate_variable_font_sliders:function(e){},setJSON:function(){}});function l(e,t,o){return t in e?Object.defineProperty(e,t,{value:o,enumerable:!0,configurable:!0,writable:!0}):e[t]=o,e}var r=Marionette.View.extend((l(a={template:"#row-view",tagName:"tbody",className:function(){return"textformat-"+this.model.get("formatname")},regions:{variableFontsAxes:".variable-font-axes-region",variableFontsPresets:".variable-font-instances-region"},templateContext:function(){var e=this,t=this.model;return{showFormatName:function(){return t.get("formatname")},showFormatType:function(){return t.get("type")},showText:function(){switch(t.get("type")){case"Paragraph":case"Headline":case"Character":return"A heat dome will build over the Midwest and East by late week, sending temperatures soaring well above average:â€¦"}},getStyleDesktop:function(){return e.triggerMethod("get:style:desktop")},getStyleTablet:function(){return e.triggerMethod("get:style:tablet")},getStylePhone:function(){return e.triggerMethod("get:style:phone")},getSpaceBottomStyleDesktop:function(){if("Character"!=t.get("type")){var e=t.get("spacebottommu");return void 0===e&&(e="px"),String()+'style="height:'+t.get("spacebottom")+e+';"'}return String()+'style="height:0;"'},getSpaceTopStyleDesktop:function(){if("Character"!=t.get("type")){var e=t.get("spacetopmu");return void 0===e&&(e="px"),String()+'style="height:'+t.get("spacetop")+e+';"'}return String()+'style="height:0;"'},getSpaceBottomStylePhone:function(){if("Character"!=t.get("type")){var e=t.get("phone-spacebottom");void 0===e&&(e="20");var o=t.get("phone-spacebottommu");return void 0===o&&(o="px"),String()+'style="height:'+e+o+';"'}return String()+'style="height:0;"'},getSpaceTopStylePhone:function(){if("Character"!=t.get("type")){var e=t.get("phone-spacetop");void 0===e&&(e="0");var o=t.get("phone-spacetopmu");return void 0===o&&(o="px"),String()+'style="height:'+e+o+';"'}return String()+'style="height:0;"'},getSpaceBottomStyleTablet:function(){if("Character"!=t.get("type")){var e=t.get("tablet-spacebottom");void 0===e&&(e="20");var o=t.get("tablet-spacebottommu");return void 0===o&&(o="px"),String()+'style="height:'+e+o+';"'}return String()+'style="height:0;"'},getSpaceTopStyleTablet:function(){if("Character"!=t.get("type")){var e=t.get("tablet-spacetop");void 0===e&&(e="0");var o=t.get("tablet-spacetopmu");return void 0===o&&(o="px"),String()+'style="height:'+e+o+';"'}return String()+'style="height:0;"'}}},events:{"change .js-existing-format-type-select":"changeType","change .js-headline-type-select":"changeHeadlineType","click .js-font-style-italic":"toggleItalic","click .js-font-style-underline":"toggleUnderline","click .js-font-style-border-bottom":"toggleBorderBottom","click .js-font-style-caps":"toggleCaps","click .js-delete-row":"deleteRow","change .font-size-mu":"updateFontMu","change .font-select":"updateFont","change .font-weight-select":"updateFontWeight","input .font-size":"updateFontSize","input .line-height":"updateLineHeight","change .line-height-mu":"updateLineHeightMu","input .letter-spacing":"updateLetterSpacing","input .space-bottom":"updateSpaceBottom","input .space-top":"updateSpaceTop","input .text-indent":"updateTextIndent","click .align-js":"updateTextAlign","input .phone-line-height":"phoneUpdateLineHeight","change .phone-line-height-mu":"phoneUpdateLineHeightMu","change .phone-font-size-mu":"phoneUpdateFontMu","input .phone-font-size":"phoneUpdateFontSize","input .phone-space-bottom":"phoneUpdateSpaceBottom","input .phone-space-top":"phoneUpdateSpaceTop","input .tablet-line-height":"tabletUpdateLineHeight","change .tablet-line-height-mu":"tabletUpdateLineHeightMu","change .tablet-font-size-mu":"tabletUpdateFontMu","input .tablet-font-size":"tabletUpdateFontSize","input .tablet-space-bottom":"tabletUpdateSpaceBottom","input .tablet-space-top":"tabletUpdateSpaceTop","change .space-bottom-mu":"updateSpaceBottomMu","change .space-top-mu":"updateSpaceTopMu","change .phone-space-bottom-mu":"phoneUpdateSpaceBottomMu","change .phone-space-top-mu":"phoneUpdateSpaceTopMu","change .tablet-space-bottom-mu":"tabletUpdateSpaceBottomMu","change .tablet-space-top-mu":"tabletUpdateSpaceTopMu","click .textformat-collapsable":"onCollapsableClick"},onCollapsableClick:function(e){var t=this.model.get("collapsed",t);void 0===t&&(t=!1),0==t?(this.$el.addClass("lay-textformat-collapsed"),this.model.set("collapsed",!0)):(this.$el.removeClass("lay-textformat-collapsed"),this.model.set("collapsed",!1)),j.updateJSON()},changeHeadlineType:function(e){var t=e.target.value;this.model.set("headlinetype",t),j.updateJSON()},changeType:function(e){var t=e.target.value;this.model.set("type",t),j.updateJSON(),this.render()},updateLineHeightMu:function(e){var t=e.target.value;this.model.set("lineheightmu",t);var o=this.model.get("lineheight");formatslgPassedData.advancedLineHeights?this.$el.find(".js-desktop-style, .js-desktop-style p").css("line-height",o+t):this.$el.find(".js-style, .js-style p").css("line-height",o),j.updateJSON()},tabletUpdateLineHeightMu:function(e){var t=e.target.value;this.model.set("tablet-lineheightmu",t);var o=this.model.get("tablet-lineheight");void 0===o&&(o="1.2"),this.$el.find(".js-tablet-style, .js-tablet-style p").css("line-height",o+t),j.updateJSON()},phoneUpdateLineHeightMu:function(e){var t=e.target.value;this.model.set("phone-lineheightmu",t);var o=this.model.get("phone-lineheight");void 0===o&&(o="1.2"),this.$el.find(".js-phone-style, .js-phone-style p").css("line-height",o+t),FormatsManager.Entities.API.updateJSON()},updateLineHeight:function(e){var t=e.target.value;if(formatslgPassedData.advancedLineHeights){var o=this.model.get("lineheightmu");void 0===o&&(o=""),this.$el.find(".js-desktop-style, .js-desktop-style p").css("line-height",t+o)}else this.$el.find(".js-style, .js-style p").css("line-height",t);this.model.set("lineheight",t),j.updateJSON()},phoneUpdateLineHeight:function(e){var t=e.target.value,o=this.model.get("phone-lineheightmu");void 0===o&&(o=""),this.$el.find(".js-phone-style, .js-phone-style p").css("line-height",t+o),this.model.set("phone-lineheight",t),j.updateJSON()},tabletUpdateLineHeight:function(e){var t=e.target.value,o=this.model.get("tablet-lineheightmu");void 0===o&&(o=""),this.$el.find(".js-tablet-style, .js-tablet-style p").css("line-height",t+o),this.model.set("tablet-lineheight",t),j.updateJSON()},onGetStyleDesktop:function(e){var t="font-family:"+this.model.get("fontfamily")+";",o=this.model.get("fontsizemu");void 0===o&&(o="px");var i=this.model.get("textindent");void 0===i&&(i="0");var a=this.model.get("borderbottom");a=void 0!==a&&1==a?"border-bottom:1px solid;display:inline;":"";var n=this.model.get("italic");n=void 0!==n&&1==n?"font-style:italic;":"";var s=this.model.get("underline");s=void 0!==s&&1==s?"text-decoration:underline;":"";var l=this.model.get("caps");l=void 0!==l&&1==l?"text-transform:uppercase;":"";var r="";formatslgPassedData.advancedLineHeights&&(void 0===(r=this.model.get("lineheightmu"))&&(r=""));var p=String()+"font-size:"+this.model.get("fontsize")+o+";color:"+this.model.get("color")+";line-height:"+this.model.get("lineheight")+r+";letter-spacing:"+this.model.get("letterspacing")+"em;"+t+"text-align:"+this.model.get("textalign")+";font-weight:"+this.model.get("fontweight")+";text-indent:"+i+"em;"+a+n+s+l;return void 0!==e&&(p+=e),p},onGetStyleTablet:function(e){var t="font-family:"+this.model.get("fontfamily")+";",o=this.model.get("tablet-fontsizemu");void 0===o&&(o="px");var i=this.model.get("textindent");void 0===i&&(i="0");var a=this.model.get("tablet-fontsize");void 0===a&&(a="16");var n=this.model.get("borderbottom");n=void 0!==n&&1==n?"border-bottom:1px solid;display:inline;":"";var s=this.model.get("italic");s=void 0!==s&&1==s?"font-style:italic;":"";var l=this.model.get("underline");l=void 0!==l&&1==l?"text-decoration:underline;":"";var r=this.model.get("caps");r=void 0!==r&&1==r?"text-transform:uppercase;":"";var p="",d=this.model.get("lineheight");formatslgPassedData.advancedLineHeights&&(void 0===(p=this.model.get("tablet-lineheightmu"))&&(p=""),void 0===(d=this.model.get("tablet-lineheight"))&&(d="1.2"));var c=String()+"font-size:"+a+o+";color:"+this.model.get("color")+";line-height:"+d+p+";letter-spacing:"+this.model.get("letterspacing")+"em;"+t+"text-align:"+this.model.get("textalign")+";font-weight:"+this.model.get("fontweight")+";text-indent:"+i+"em;"+n+s+l+r;return void 0!==e&&(c+=e),c},onGetStylePhone:function(e){var t="font-family:"+this.model.get("fontfamily")+";",o=this.model.get("phone-fontsizemu");void 0===o&&(o="px");var i=this.model.get("textindent");void 0===i&&(i="0");var a=this.model.get("phone-fontsize");void 0===a&&(a="16");var n=this.model.get("borderbottom");n=void 0!==n&&1==n?"border-bottom:1px solid;display:inline;":"";var s=this.model.get("italic");s=void 0!==s&&1==s?"font-style:italic;":"";var l=this.model.get("underline");l=void 0!==l&&1==l?"text-decoration:underline;":"";var r=this.model.get("caps");r=void 0!==r&&1==r?"text-transform:uppercase;":"";var p="",d=this.model.get("lineheight");formatslgPassedData.advancedLineHeights&&(void 0===(p=this.model.get("phone-lineheightmu"))&&(p=""),void 0===(d=this.model.get("phone-lineheight"))&&(d="1.2"));var c=String()+"font-size:"+a+o+";color:"+this.model.get("color")+";line-height:"+d+p+";letter-spacing:"+this.model.get("letterspacing")+"em;"+t+"text-align:"+this.model.get("textalign")+";font-weight:"+this.model.get("fontweight")+";text-indent:"+i+"em;"+n+s+l+r;return void 0!==e&&(c+=e),c},toggleCaps:function(e){jQuery(e.currentTarget).toggleClass("active"),jQuery(e.currentTarget).hasClass("active")?(this.model.set("caps",!0),this.$el.find(".js-phone-style, .js-phone-style p, .js-tablet-style, .js-tablet-style p, .js-desktop-style, .js-desktop-style p").css("text-transform","uppercase")):(this.model.set("caps",!1),this.$el.find(".js-phone-style, .js-phone-style p, .js-tablet-style, .js-tablet-style p, .js-desktop-style, .js-desktop-style p").css("text-transform","")),j.updateJSON()},toggleBorderBottom:function(e){if(jQuery(e.currentTarget).toggleClass("active"),jQuery(e.currentTarget).hasClass("active")){var t=this.model.get("underline");void 0!==t&&1==t&&this.$el.find(".js-font-style-underline").click(),this.model.set("borderbottom",!0),this.$el.find(".js-phone-style, .js-phone-style p, .js-tablet-style, .js-tablet-style p, .js-desktop-style, .js-desktop-style p").css({"border-bottom":"1px solid",display:"inline"})}else this.model.set("borderbottom",!1),this.$el.find(".js-phone-style, .js-phone-style p, .js-tablet-style, .js-tablet-style p, .js-desktop-style, .js-desktop-style p").css({"border-bottom":"",display:""});j.updateJSON()},toggleUnderline:function(e){if(jQuery(e.currentTarget).toggleClass("active"),jQuery(e.currentTarget).hasClass("active")){var t=this.model.get("borderbottom");void 0!==t&&1==t&&this.$el.find(".js-font-style-border-bottom").click(),this.model.set("underline",!0),this.$el.find(".js-phone-style, .js-phone-style p, .js-tablet-style, .js-tablet-style p, .js-desktop-style, .js-desktop-style p").css("text-decoration","underline")}else this.model.set("underline",!1),this.$el.find(".js-phone-style, .js-phone-style p, .js-tablet-style, .js-tablet-style p, .js-desktop-style, .js-desktop-style p").css("text-decoration","");j.updateJSON()},toggleItalic:function(e){jQuery(e.currentTarget).toggleClass("active"),jQuery(e.currentTarget).hasClass("active")?(this.model.set("italic",!0),this.$el.find(".js-phone-style, .js-phone-style p, .js-tablet-style, .js-tablet-style p, .js-desktop-style, .js-desktop-style p").css("font-style","italic")):(this.model.set("italic",!1),this.$el.find(".js-phone-style, .js-phone-style p, .js-tablet-style, .js-tablet-style p, .js-desktop-style, .js-desktop-style p").css("font-style","")),j.updateJSON()},phoneUpdateFontSize:function(e){var t=e.target.value,o=this.model.get("phone-fontsizemu");void 0===o&&(o="px"),this.$el.find(".js-phone-style, .js-phone-style p").css("font-size",t+o),this.model.set("phone-fontsize",t),j.updateJSON()},tabletUpdateFontSize:function(e){var t=e.target.value,o=this.model.get("tablet-fontsizemu");void 0===o&&(o="px"),this.$el.find(".js-tablet-style, .js-tablet-style p").css("font-size",t+o),this.model.set("tablet-fontsize",t),j.updateJSON()},updateFontSize:function(e){var t=e.target.value,o=this.model.get("fontsizemu");void 0===o&&(o="px"),this.$el.find(".js-desktop-style, .js-desktop-style p").css("font-size",t+o),this.model.set("fontsize",t),j.updateJSON()},phoneUpdateFontMu:function(e){var t=e.target.value;this.model.set("phone-fontsizemu",t);var o="vw"==t?4:16;this.model.set("phone-fontsize",o),this.$el.find(".js-phone-style, .js-phone-style p").css("font-size",o+t),this.$el.find(".phone-font-size").val(o),j.updateJSON()},tabletUpdateFontMu:function(e){var t=e.target.value;this.model.set("tablet-fontsizemu",t);var o="vw"==t?4:16;this.model.set("tablet-fontsize",o),this.$el.find(".js-tablet-style, .js-tablet-style p").css("font-size",o+t),this.$el.find(".tablet-font-size").val(o),j.updateJSON()},updateFontMu:function(e){var t=e.target.value;this.model.set("fontsizemu",t);var o="vw"==t?4:16;this.model.set("fontsize",o),this.$el.find(".js-desktop-style, .js-desktop-style p").css("font-size",o+t),this.$el.find(".font-size").val(o),j.updateJSON()},updateTextAlign:function(e){var t=jQuery(e.currentTarget),o=t.attr("data-align");jQuery("button.align-js").removeClass("active"),t.addClass("active"),this.$el.find(".js-style, .js-style p").css("text-align",o),this.model.set("textalign",o),j.updateJSON()},updateSpaceBottom:function(e){var t=e.target.value,o=this.model.get("spacebottommu");void 0===o&&(o="px"),this.$el.find(".js-desktop-spacebottom").css("height",t+o),this.model.set("spacebottom",t),j.updateJSON()},updateSpaceBottomMu:function(e){var t=e.target.value;this.model.set("spacebottommu",t);var o=this.model.get("spacebottom");this.$el.find(".js-desktop-spacebottom").css("height",o+t),j.updateJSON()},updateSpaceTop:function(e){var t=e.target.value,o=this.model.get("spacetopmu");void 0===o&&(o="px"),this.$el.find(".js-desktop-spacetop").css("height",t+o),this.model.set("spacetop",t),j.updateJSON()},updateSpaceTopMu:function(e){var t=e.target.value;this.model.set("spacetopmu",t);var o=this.model.get("spacetop");this.$el.find(".js-desktop-spacetop").css("height",o+t),j.updateJSON()},phoneUpdateSpaceBottom:function(e){var t=e.target.value,o=this.model.get("phone-spacebottommu");void 0===o&&(o="px"),this.$el.find(".js-phone-spacebottom").css("height",t+o),this.model.set("phone-spacebottom",t),j.updateJSON()},phoneUpdateSpaceBottomMu:function(e){var t=e.target.value;this.model.set("phone-spacebottommu",t);var o=this.model.get("phone-spacebottom");this.$el.find(".js-phone-spacebottom").css("height",o+t),j.updateJSON()},phoneUpdateSpaceTop:function(e){var t=e.target.value,o=this.model.get("phone-spacetopmu");void 0===o&&(o="px"),this.$el.find(".js-phone-spacetop").css("height",t+o),this.model.set("phone-spacetop",t),j.updateJSON()},tabletUpdateSpaceTopMu:function(e){var t=e.target.value;this.model.set("tablet-spacetopmu",t);var o=this.model.get("tablet-spacetop");this.$el.find(".js-tablet-spacetop").css("height",o+t),j.updateJSON()},tabletUpdateSpaceBottom:function(e){var t=e.target.value,o=this.model.get("tablet-spacebottommu");void 0===o&&(o="px"),this.$el.find(".js-tablet-spacebottom").css("height",t+o),this.model.set("tablet-spacebottom",t),j.updateJSON()},tabletUpdateSpaceBottomMu:function(e){var t=e.target.value;this.model.set("tablet-spacebottommu",t);var o=this.model.get("tablet-spacebottom");this.$el.find(".js-tablet-spacebottom").css("height",o+t),j.updateJSON()},tabletUpdateSpaceTop:function(e){var t=e.target.value,o=this.model.get("tablet-spacetopmu");void 0===o&&(o="px"),this.$el.find(".js-tablet-spacetop").css("height",t+o),this.model.set("tablet-spacetop",t),j.updateJSON()}},"tabletUpdateSpaceTopMu",function(e){var t=e.target.value;this.model.set("tablet-spacetopmu",t);var o=this.model.get("tablet-spacetop");this.$el.find(".js-tablet-spacetop").css("height",o+t),j.updateJSON()}),l(a,"updateFont",function(e){var t=e.target.value;this.$el.find(".js-style, .js-style p").css("font-family",t),this.model.set("fontfamily",t),this.getRegion("variableFontsAxes").empty(),this.getRegion("variableFontsPresets").empty(),this.$el.find(".variable-font-instances-region").html(""),this.model.unset("variablesettings"),this.model.unset("variable-preset-index"),this.generateVariableFontSliders(),j.updateJSON()}),l(a,"updateFontWeight",function(e){var t=e.target.value;this.$el.find(".js-style, .js-style p").css("font-weight",t),this.model.set("fontweight",t),j.updateJSON()}),l(a,"updateLetterSpacing",function(e){var t=e.target.value;this.$el.find(".js-style, .js-style p").css("letter-spacing",t+"em"),this.model.set("letterspacing",t),j.updateJSON()}),l(a,"updateTextIndent",function(e){var t=e.target.value;this.$el.find(".js-style, .js-style p").css("text-indent",t+"em"),this.model.set("textindent",t),j.updateJSON()}),l(a,"updateColor",function(e){this.$el.find(".js-style, .js-style p").css("color",e),this.model.set("color",e),j.updateJSON(),this.updatePreviewBgColor()}),l(a,"deleteRow",function(e){e.preventDefault(),e.stopPropagation(),h.deleteFontRow(this.model)}),l(a,"onRender",function(){h.setInputAttrs(this.$el,this.model);var e=this,t=this.$el.find(".colorpicker");jQuery(t[0]).iris({hide:!0,palettes:["#000","#fff","#f00","#0f0","#00f","#ff0","#0ff","#f0f"],change:function(t,o){e.updateColor(o.color.toString())}}),e.updatePreviewBgColor(),e.generateVariableFontSliders(),this.$el.attr("cid",this.model.cid)}),l(a,"generateVariableFontSliders",function(){s.generate_variable_font_sliders(this)}),l(a,"onChildviewPresetSelected",function(e,t){var o=this.getRegion("variableFontsAxes").currentView;for(var i in t.coordinates){o.collection.findWhere({tag:i}).set("value",t.coordinates[i])}o.render(),this.model.set("variable-preset-index",e),j.updateJSON()}),l(a,"onChildviewFontAxesUpdated",function(e,t){this.triggerMethod("maybe:deselect:preset"),this.model.set("variablesettings",t.toJSON()),j.updateJSON(),this.$el.find(".js-desktop-style").attr("style",this.triggerMethod("get:style:desktop",e)),this.$el.find(".js-tablet-style").attr("style",this.triggerMethod("get:style:tablet",e)),this.$el.find(".js-phone-style").attr("style",this.triggerMethod("get:style:phone",e))}),l(a,"onMaybeDeselectPreset",function(){var e=this.getRegion("variableFontsAxes").currentView,t=this.getRegion("variableFontsPresets").currentView;void 0!==t&&t.triggerMethod("maybe:deselect",e.collection)}),l(a,"updatePreviewBgColor",function(){"#ffffff"==this.model.get("color")?this.$el.find(".format-preview-wrap").css("background-color","rgb(235, 235, 235)"):this.$el.find(".format-preview-wrap").css("background-color","")}),a)),p=Marionette.CompositeView.extend({tagName:"div",template:"#row-composite-view",childViewContainer:".js-formats-table",childView:r,events:{"click .js-add-format":"addFormat"},addFormat:function(e){e.preventDefault(),h.insertRow()}});function d(e,t,o){return t in e?Object.defineProperty(e,t,{value:o,enumerable:!0,configurable:!0,writable:!0}):e[t]=o,e}var c={rowsView:null},h={initRows:function(e){f(e)},setRowOrder:function(){g()},getRowsView:function(){return c.rowsView},insertRow:function(e){m(e)},deleteFontRow:function(e){v(e)},setInputAttrs:function(e,t){u(e,t)}},g=function(){for(var e=[],t=c.rowsView.$childViewContainer[0].children,o=0;o<t.length;o++){var i=t[o].attributes.cid.value;e[i]=o}console.log(e),c.rowsView.children.each(function(t,o){var i=t.model.cid,a=e[i];t.model.set("index",a)}),c.rowsView.collection.sort(),j.updateJSON(),console.log(c.rowsView)},u=function(e,t){var o=t.get("collapsed");void 0!==o&&1==o?e.addClass("lay-textformat-collapsed"):e.removeClass("lay-textformat-collapsed");var i=t.get("headlinetype");void 0!==i?e.find('.js-headline-type-select option[value="'+i+'"]').attr("selected","selected"):e.find('.js-headline-type-select option[value="h1"]').attr("selected","selected");var a=t.get("lineheight");e.find(".line-height").val(a);var n=t.get("lineheightmu");void 0!==n&&e.find('.line-height-mu option[value="'+n+'"]').attr("selected","selected");var s=t.get("tablet-lineheight");void 0!==s&&e.find(".tablet-line-height").val(s);var l=t.get("tablet-lineheightmu");void 0!==l&&e.find('.tablet-line-height-mu option[value="'+l+'"]').attr("selected","selected");var r=t.get("phone-lineheight");void 0!==r&&e.find(".phone-line-height").val(r);var p=t.get("phone-lineheightmu");void 0!==p&&e.find('.phone-line-height-mu option[value="'+p+'"]').attr("selected","selected");var d=t.get("fontsizemu");void 0===d&&(d="px"),e.find('.font-size-mu option[value="'+d+'"]').attr("selected","selected");var c=t.get("phone-fontsizemu");void 0===c&&(c="px"),e.find('.phone-font-size-mu option[value="'+c+'"]').attr("selected","selected");var h=t.get("tablet-fontsizemu");void 0===h&&(h="px"),e.find('.tablet-font-size-mu option[value="'+h+'"]').attr("selected","selected");var g=t.get("fontsize");e.find(".font-size").val(g);var u=t.get("phone-fontsize");void 0===u&&(u="16"),e.find(".phone-font-size").val(u);var m=t.get("tablet-fontsize");void 0===m&&(m="16"),e.find(".tablet-font-size").val(m),g=t.get("color"),e.find(".colorpicker").val(g),g=t.get("letterspacing"),e.find(".letter-spacing").val(g),g=t.get("spacebottom"),e.find(".space-bottom").val(g),g=t.get("spacetop"),e.find(".space-top").val(g);var v=t.get("phone-spacetop");void 0===v&&(v="0"),e.find(".phone-space-top").val(v);var f=t.get("phone-spacebottom");void 0===f&&(f="20"),e.find(".phone-space-bottom").val(f);var b=t.get("tablet-spacetop");void 0===b&&(b="0"),e.find(".tablet-space-top").val(b);var y=t.get("tablet-spacebottom");void 0===y&&(y="20"),e.find(".tablet-space-bottom").val(y);var j=t.get("textindent");void 0!==j&&e.find(".text-indent").val(j);var S=t.get("textalign");void 0!==S&&(e.find(".text-align-row button").removeClass("active"),e.find('.text-align-row button[data-align="'+S+'"]').addClass("active"));var x=t.get("fontweight");"normal"!=x&&void 0!==x||(x="400"),e.find('.font-weight-select option[value="'+x+'"]').attr("selected","selected"),g=t.get("fontfamily"),e.find('.font-select option[value="'+g+'"]').length&&e.find('.font-select option[value="'+g+'"]').attr("selected","selected");var w=t.get("borderbottom");void 0!==w&&1==w&&e.find(".js-font-style-border-bottom").addClass("active");var z=t.get("italic");void 0!==z&&1==z&&e.find(".js-font-style-italic").addClass("active");var O=t.get("underline");void 0!==O&&1==O&&e.find(".js-font-style-underline").addClass("active");var $=t.get("caps");void 0!==$&&1==$&&e.find(".js-font-style-caps").addClass("active");var N=t.get("spacebottommu");void 0===N&&(N="px"),e.find('.space-bottom-mu option[value="'+N+'"]').attr("selected","selected");var k=t.get("spacetopmu");void 0===k&&(k="px"),e.find('.space-top-mu option[value="'+k+'"]').attr("selected","selected");var J=t.get("phone-spacebottommu");void 0===J&&(J="px"),e.find('.phone-space-bottom-mu option[value="'+J+'"]').attr("selected","selected");var M=t.get("phone-spacetopmu");void 0===M&&(M="px"),e.find('.phone-space-top-mu option[value="'+M+'"]').attr("selected","selected");var C=t.get("tablet-spacebottommu");void 0===C&&(C="px"),e.find('.tablet-space-bottom-mu option[value="'+C+'"]').attr("selected","selected");var T=t.get("tablet-spacetopmu");void 0===T&&(T="px"),e.find('.tablet-space-top-mu option[value="'+T+'"]').attr("selected","selected");var V=t.get("type");e.find('.js-existing-format-type-select option[value="'+V+'"]').attr("selected","selected")},m=function(){var e=jQuery(".js-format-name-input").val(),t=jQuery(".js-format-type").val();jQuery(".js-format-name-input").val("").removeClass("parsley-success"),jQuery(".js-add-format").attr("disabled","disabled");var o=jQuery(".js-copy-formats").val(),i=null;""==o?i=new Backbone.Model({formatname:e,headlinetype:"h1",type:t,fontfamily:"helvetica,sans-serif",fontsize:"16",fontsizemu:"px",fontweight:"400",color:"#000",lineheight:"1.2",lineheightmu:"",letterspacing:"0",spacebottom:"20",spacebottommu:"px",spacetop:"0",spacetopmu:"px",textalign:"left","text-indent":"0","phone-lineheight":"1.2","phone-lineheightmu":"","phone-spacetop":"0","phone-spacetopmu":"px","phone-spacebottom":"20","phone-spacebottommu":"px","phone-fontsize":"16","phone-fontsizemu":"px","tablet-lineheight":"1.2","tablet-lineheightmu":"","tablet-spacetop":"0","tablet-spacetopmu":"px","tablet-spacebottom":"20","tablet-spacebottommu":"px","tablet-fontsize":"16","tablet-fontsizemu":"px",italic:!1,underline:!1,borderbottom:!1,caps:!1,collapsed:!1}):c.rowsView.collection.each(function(a){if(a.get("formatname")==o){var n,s=a.get("headlinetype");void 0===s&&(s="h1");var l=a.get("phone-spacetop");void 0===l&&(l=a.get("spacetop"));var r=a.get("phone-spacebottom");void 0===r&&(r=a.get("spacebottom"));var p=a.get("phone-fontsize");void 0===p&&(p="16");var c=a.get("phone-fontsizemu");void 0===c&&(c="px");var h=a.get("tablet-spacetop");void 0===h&&(h=a.get("spacetop"));var g=a.get("tablet-spacebottom");void 0===g&&(g=a.get("spacebottom"));var u=a.get("tablet-fontsize");void 0===u&&(u="16");var m=a.get("tablet-fontsizemu");void 0===m&&(m="px");var v=a.get("textindent");void 0===v&&(v=0);var f=a.get("fontsizemu");void 0===f&&(f="px");var b=a.get("spacebottommu");void 0===b&&(b="px");var y=a.get("spacetopmu");void 0===y&&(y="px");var j=a.get("phone-spacebottommu");void 0===j&&(j="px");var S=a.get("phone-spacetopmu");void 0===S&&(S="px");var x=a.get("tablet-spacebottommu");void 0===x&&(x="px");var w=a.get("tablet-spacetopmu");void 0===w&&(w="px");var z=a.get("caps");void 0===z&&(z=!1);var O=a.get("underline");void 0===O&&(O=!1);var $=a.get("borderbottom");void 0===$&&($=!1);var N=a.get("italic");void 0===N&&(N=!1);var k=a.get("lineheightmu");void 0===k&&(k="");var J=a.get("tablet-lineheight");void 0===k&&(J="1.2");var M=a.get("tablet-lineheightmu");void 0===M&&(M="");var C=a.get("phone-lineheight");void 0===C&&(C="1.2");var T=a.get("phone-lineheightmu");void 0===T&&(T=""),i=new Backbone.Model((d(n={formatname:e,type:t,headlinetype:s,fontfamily:a.get("fontfamily"),fontsize:a.get("fontsize"),fontsizemu:f,fontweight:a.get("fontweight"),color:a.get("color"),lineheight:a.get("lineheight"),lineheightmu:k},"lineheight",a.get("lineheight")),d(n,"letterspacing",a.get("letterspacing")),d(n,"spacebottom",a.get("spacebottom")),d(n,"spacebottommu",b),d(n,"spacetop",a.get("spacetop")),d(n,"spacetopmu",y),d(n,"textalign",a.get("textalign")),d(n,"text-indent",v),d(n,"phone-lineheight",C),d(n,"phone-lineheightmu",T),d(n,"phone-spacetop",l),d(n,"phone-spacetopmu",S),d(n,"phone-spacebottom",r),d(n,"phone-spacebottommu",j),d(n,"phone-fontsize",p),d(n,"phone-fontsizemu",c),d(n,"tablet-lineheight",J),d(n,"tablet-lineheightmu",M),d(n,"tablet-spacetop",h),d(n,"tablet-spacetopmu",w),d(n,"tablet-spacebottom",g),d(n,"tablet-spacebottommu",x),d(n,"tablet-fontsize",u),d(n,"tablet-fontsizemu",m),d(n,"italic",N),d(n,"underline",O),d(n,"borderbottom",$),d(n,"caps",z),d(n,"collapsed",!1),n))}}),c.rowsView.collection.add(i),j.updateJSON(),jQuery('[data-toggle="tooltip"]').tooltip({container:"#formatsmanager"})},v=function(e){c.rowsView.collection.remove(e),j.updateJSON()},f=function(e){c.rowsView=new p({collection:e}),b()},b=function(){},y={jsonObject:null},j={getRowsEntities:function(){return x()},updateJSON:function(){z()},getJSON:function(){w()},getJSONObject:function(){return y.jsonObject},getFontsJSONObject:function(){return O()}},S=Backbone.Collection.extend({comparator:function(e){return e.get("index")}}),x=function(){var e=[];return null!=y.jsonObject&&(e=y.jsonObject),new S(e)},w=function(){var e=jQuery.trim(jQuery("#formatsmanager_json").val());if(void 0!==e&&""!=e){var t=JSON.parse(e);y.jsonObject=t}},z=function(){var e=h.getRowsView().collection.toJSON(),t=window.JSON.stringify(e,void 0,2);jQuery("#formatsmanager_json").val(t)},O=function(){var e=jQuery.trim(jQuery("#fontmanager_json").val());if(void 0!==e&&""!=e)return JSON.parse(e)},$={showManager:function(e){N(e)}},N=function(e){s.setJSON(),j.getJSON();var t=j.getRowsEntities();h.initRows(t);var o=h.getRowsView();e.showView(o),window.ParsleyValidator.addValidator("isother",function(e,t){var o=!0;return jQuery(".js-format-name").each(function(){jQuery(this).attr("data-name")==e&&(o=!1)}),o},32).addMessage("en","isother","This name is already used."),jQuery.listen("parsley:field:error",function(e){var t=ParsleyUI.getErrorsMessages(e).join(";");e.$element.popover({container:"body",placement:"bottom",content:t}).popover("show")}),jQuery.listen("parsley:field:success",function(e){e.$element.popover("hide")}),jQuery(".js-format-name-input").on("input propertychange",function(){1==jQuery(this).parsley().validate()?jQuery(".js-add-format").removeAttr("disabled"):jQuery(".js-add-format").attr("disabled","disabled")}),jQuery('[data-toggle="tooltip"]').tooltip({container:"#formatsmanager"})},k=Marionette.Application.extend({region:"#formatsmanager",onStart:function(){$.showManager(this),setTimeout(function(){J()},1e3)}}),J=function(){var e=document.getElementById("textformats-table");new Sortable(e,{animation:150,handle:".drag-icon",onEnd:function(e){h.setRowOrder()}})};(new k).start()}]);